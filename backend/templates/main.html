{% extends "base.html" %}

{% block content %}
<div class="text-center mb-5 animate-fade-in">
    <h1 class="display-5 fw-bold">Disease Probability Calculator</h1>
    <p class="lead text-muted">Leveraging Bayes' Theorem for accurate diagnostic insights.</p>
</div>

<div class="row g-4 justify-content-center">
    <!-- Section 1: Use Existing Data -->
    <div class="col-lg-6 col-md-12">
        <div class="card h-100 shadow-sm card-hover">
            <div class="card-body p-4">
                <h2 class="card-title h4 text-center mb-4">Use Pre-loaded Hospital Data</h2>
                <div class="mb-3">
                    <label for="diseaseSelect" class="form-label">Select Disease or Choose one:</label>
                    <select id="diseaseSelect" class="form-select form-select-lg">
                        {% for disease in diseases %}
                        <option value="{{ disease }}">{{ disease }}</option>
                        {% endfor %}
                    </select>


                </div>
                <div class="d-grid">
                    <button type="button" class="btn btn-primary btn-lg" onclick="usePreset()">Calculate with Sample Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 2: Enter New Data -->
    <div class="col-lg-6 col-md-12">
        <div class="card h-100 shadow-sm card-hover">
            <div class="card-body p-4">
                <h2 class="card-title h4 text-center mb-4">Enter Custom Disease Data</h2>
                <div class="mb-3">
                    <label for="pD" class="form-label">Prior Probability of Disease - P(D)</label>
                    <input type="number" id="pD" class="form-control form-control-lg" step="0.01" min="0" max="1" placeholder="e.g., 0.01">
                </div>
                <div class="mb-3">
                    <label for="sensitivity" class="form-label">Test Sensitivity - P(Pos | D)</label>
                    <input type="number" id="sensitivity" class="form-control form-control-lg" step="0.01" min="0" max="1" placeholder="e.g., 0.99">
                </div>
                <div class="mb-3">
                    <label for="falsePositive" class="form-label">False Positive Rate - P(Pos | No D)</label>
                    <input type="number" id="falsePositive" class="form-control form-control-lg" step="0.01" min="0" max="1" placeholder="e.g., 0.05">
                </div>
                <div class="d-grid">
                    <button type="button" class="btn btn-success btn-lg" onclick="calculateDisease()">Calculate Probability</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Result Display Area -->
<div id="result" class="alert alert-success fs-4 mt-5 p-4 text-center shadow-lg " role="alert">
    <!-- Result will be injected here by script.js -->
</div>

<!-- NEW: Chart Display Area -->
<div id="chartContainer" class="card shadow-lg mt-4" style="display: none;">
    <div class="card-body p-4">
        <h3 class="card-title text-center mb-3">Probability Comparison</h3>
        <div class="chart-wrapper" style="height: 300px;">
            <canvas id="probabilityChartCanvas"></canvas>
        </div>
    </div>
</div>



<script>
$(document).ready(function() {
    $('#diseaseSelect').select2({
        placeholder: "Type to search disease...",
        width: '100%',
        allowClear: true
    });
});
</script>

<!-- IMPORTANT: Add Chart.js library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}
